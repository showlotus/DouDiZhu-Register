var L=Object.defineProperty;var b=(e,n,t)=>n in e?L(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var p=(e,n,t)=>(b(e,typeof n!="symbol"?n+"":n,t),t),S=(e,n,t)=>{if(!n.has(e))throw TypeError("Cannot "+t)};var a=(e,n,t)=>(S(e,n,"read from private field"),t?t.call(e):n.get(e)),m=(e,n,t)=>{if(n.has(e))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(e):n.set(e,t)},f=(e,n,t,s)=>(S(e,n,"write to private field"),s?s.call(e,t):n.set(e,t),t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var v,u,l;class I{constructor(...n){m(this,v,void 0);m(this,u,void 0);m(this,l,void 0);f(this,v,n),f(this,u,new Map),f(this,l,[]),this.init(),this.notify()}init(){const n=[["JOKER",1],["joker",1],["2",4],["A",4],["K",4],["Q",4],["J",4],["10",4],["9",4],["8",4],["7",4],["6",4],["5",4],["4",4],["3",4]],t=new Map;n.forEach(([s,r])=>{t.set(s,r)}),f(this,u,t)}update(n,t){Object.keys(n).forEach(r=>{n[r]=Math.min(n[r],a(this,u).get(r)),a(this,u).set(r,a(this,u).get(r)-n[r])}),a(this,l).push([n,t]),this.notify()}notify(){a(this,v).forEach(n=>n.render({data:a(this,u),history:a(this,l)}))}revocation(){const[n,t]=a(this,l).pop()||[];return!n||!Object.keys(n).length?"":(Object.keys(n).forEach(r=>{a(this,u).set(r,a(this,u).get(r)+n[r])}),this.notify(),t)}getData(){return a(this,u)}getRecords(){return a(this,l)}getLastestRecord(){return a(this,l).length?a(this,l)[a(this,l).length-1]:null}reset(){this.init(),f(this,l,[]),this.notify()}}v=new WeakMap,u=new WeakMap,l=new WeakMap;class E{constructor(){p(this,"el");this.el=document.createElement("div")}insert(){document.querySelector("#app").appendChild(this.el)}render(n){}}const A="data:image/svg+xml,%3csvg%20t='1709904722459'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='8032'%20width='128'%20height='128'%3e%3cpath%20d='M752.4%20114.6c-8.4%202.6-23.2%2015.6-26.2%2023l-2.4%205.6-40.4%202.4c-22.2%201.4-50.2%203.8-62.4%205.4-154%2020.6-253.6%2084-289.8%20184.6-3.8%2010.8-11.2%2043-11.2%2049.2%200%200-16%200.2-35.6%200.4-25.2%200-40.4%201-53.2%203.6-51.8%2010.2-89.8%2029.4-122.4%2062-26.6%2026.6-44.4%2056.8-54.2%2092.2-5.2%2018.2-6%2019.6-12.8%2023.2C27%20573.6%2016%20591.6%2016%20608c0%2024.8%2023.2%2048%2048%2048%2018.4%200%2040.4-16%2045.6-33.2%204.8-16.4%200.8-34.6-10-46.2-4.2-4.4-4.2-4.6-0.4-8.8%2011-12.2%2037-21.4%2064.8-23.2%2030.6-1.8%2048.8%205.2%2061.4%2024.2%208.6%2012.6%2012.4%2026.2%2014%2048.4%201.6%2023.4-0.6%2040.6-5%2042-21.6%206.6-39.4%2021.4-49.2%2041-12.4%2024.8-12.4%2024.8%2011.8%20106.8%2011.6%2039.6%2023.6%2079.4%2026.2%2088.4l5%2016.6H795.6l2.2-6.4c1-3.6%2013-43%2026.4-87.6%2027.6-92.4%2027.4-91.2%2014.8-117.4-9.8-19.8-27.8-34.8-49.4-41.4-4.6-1.4-6.4-15.4-5-39%202.2-36.8%2012.8-58.4%2034.4-69.2%2011.2-5.6%2013.4-6%2035-5.8%2016%200%2026.6%201%2035%203.6%2014.4%204.2%2029.2%2012%2035.2%2018.4l4.2%204.6-6%207.6c-15.6%2020-13.8%2043.2%204.6%2061.6%2020.2%2020.4%2045.8%2020.4%2066%200%2014-14%2018.2-29.2%2012.6-47.2-3-10-13.8-22.8-23.8-28-5.6-2.8-7.8-5.2-7.8-8.4%200-8.6-8.6-38.4-15.8-55.6-20.4-47-59.6-84.2-107.8-101.8-31.2-11.4-53.2-14.8-95.4-14.6-34.8%200-39.8%200.4-58%205.2-11%203-27.6%209-36.6%2013.4-9.2%204.4-17.2%208-17.6%208-1.8%200-0.6-16.4%202.2-33.2%209.6-54.6%2038-108%2082.8-155.2l19.4-20.2%206.6%202.2c16.6%205.8%2033.4%201.4%2047.2-12.6%2019.6-19.4%2020.2-44.4%201.6-65-12.8-14.4-31.8-19.4-50.2-13.4zM705.8%20198c-32.2%2035.6-50%2060.6-66.2%2092.6C620%20330%20608%20378%20608%20418.2c0%2017.4-0.4%2019.8-4%2021.8-6%203.2-31.2%2033-43%2051-13.4%2020.4-29.4%2052.4-39%2077.6l-7.4%2019.6-5.4-17.4c-13-41.2-29-72.4-57.2-111.4-4.6-6.6-3.6-49.8%201.8-70.4%2018-69%2078.8-127.8%20178.2-172.2%2020-8.8%2081-32.4%2084.8-32.8%200.8%200-4.2%206.4-11%2014z%20m77.2%20220c54%206.2%2096.4%2026.4%20122.8%2058.4%209.4%2011.4%2026%2041.6%2029.2%2053.2%201.4%204.6%201.2%204.6-9.4-1.4-19-10.6-35.8-14.6-65.8-15.6-21.8-0.8-29.4-0.4-38.8%202.4-32%209.2-51.4%2028.6-62.6%2062.6-4.2%2013.2-5.2%2020-6%2047.8-0.8%2028.4-1.2%2032.6-4.2%2032.6-6.4%200-27.4%2011.6-35.6%2019.8L704%20686l-8.4-8.4c-4.8-4.4-14.4-11-21.6-14.4-12-5.8-14.6-6.2-34-6.2-18.8%200-22.2%200.6-33%205.6-6.6%203-16.2%209.8-21.4%2014.8l-9.4%209.2-10.2-9.2c-9-8-19.8-14.4-30.4-18-4.8-1.6-4.6-5.4%202.4-32.2%2016-62.4%2043.4-115.8%2077.8-151.8%2044.6-46.6%2098.4-65.2%20167.2-57.4zM277.2%20693.6c9.2%204.8%2017%2012.8%2021.8%2022%202.4%204.8%205.4%2028.2%2011.2%2085%204.2%2043.2%207.8%2078.6%207.8%2078.8%200%200.4-14.8%200.6-32.6%200.6h-32.8l-22.2-74c-22-73.6-22.2-74-19.4-83%208.6-29%2040-42.8%2066.2-29.4z%20m128%200c9%204.6%2016.8%2012.6%2022%2022.4%203.4%206.4%203.8%2013.4%204.4%2085.6l0.6%2078.4-40.6-0.4-40.6-0.6-7.4-73c-6.8-67-7.2-73.8-4.6-83%208.2-28.6%2040-42.8%2066.2-29.4z%20m128%200c9%204.6%2016.8%2012.6%2022%2022.4%203.4%206.4%203.8%2013.4%204.4%2085.4l0.6%2078.6H464v-73.6c0-80%200.6-86%2011-99.6%2013.6-17.8%2038.4-23.4%2058.2-13.2z%20m128%200c12.6%206.6%2022.2%2018.8%2025.6%2033%200.6%203-0.6%2023.6-2.8%2045.6-2.4%2022.2-3.6%2040.8-3%2041.4%201.4%201.4%2029.4%204.6%2030.6%203.4%200.4-0.4%202.8-21.8%205.4-47.6%205-50.2%206.8-57%2018.4-67.6%2010-9.4%2018.6-12.6%2032.6-12.6%209.4%200%2015.2%201.2%2021.2%204.2%2014%207.4%2024.8%2023.2%2025.2%2037.2%200%203.6-9.6%2038.6-21.4%2077.8L771.4%20880H706l1.4-15c1.4-17%202.4-16-17.8-17.8l-13.2-1.2-1.4%2017-1.4%2017H592v-73.6c0-80%200.6-86%2011-99.6%2013.6-17.8%2038.4-23.4%2058.2-13.2z'%20p-id='8033'%20fill='%23ca3142'%3e%3c/path%3e%3c/svg%3e",$="data:image/svg+xml,%3csvg%20t='1709904722459'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='8032'%20width='128'%20height='128'%3e%3cpath%20d='M752.4%20114.6c-8.4%202.6-23.2%2015.6-26.2%2023l-2.4%205.6-40.4%202.4c-22.2%201.4-50.2%203.8-62.4%205.4-154%2020.6-253.6%2084-289.8%20184.6-3.8%2010.8-11.2%2043-11.2%2049.2%200%200-16%200.2-35.6%200.4-25.2%200-40.4%201-53.2%203.6-51.8%2010.2-89.8%2029.4-122.4%2062-26.6%2026.6-44.4%2056.8-54.2%2092.2-5.2%2018.2-6%2019.6-12.8%2023.2C27%20573.6%2016%20591.6%2016%20608c0%2024.8%2023.2%2048%2048%2048%2018.4%200%2040.4-16%2045.6-33.2%204.8-16.4%200.8-34.6-10-46.2-4.2-4.4-4.2-4.6-0.4-8.8%2011-12.2%2037-21.4%2064.8-23.2%2030.6-1.8%2048.8%205.2%2061.4%2024.2%208.6%2012.6%2012.4%2026.2%2014%2048.4%201.6%2023.4-0.6%2040.6-5%2042-21.6%206.6-39.4%2021.4-49.2%2041-12.4%2024.8-12.4%2024.8%2011.8%20106.8%2011.6%2039.6%2023.6%2079.4%2026.2%2088.4l5%2016.6H795.6l2.2-6.4c1-3.6%2013-43%2026.4-87.6%2027.6-92.4%2027.4-91.2%2014.8-117.4-9.8-19.8-27.8-34.8-49.4-41.4-4.6-1.4-6.4-15.4-5-39%202.2-36.8%2012.8-58.4%2034.4-69.2%2011.2-5.6%2013.4-6%2035-5.8%2016%200%2026.6%201%2035%203.6%2014.4%204.2%2029.2%2012%2035.2%2018.4l4.2%204.6-6%207.6c-15.6%2020-13.8%2043.2%204.6%2061.6%2020.2%2020.4%2045.8%2020.4%2066%200%2014-14%2018.2-29.2%2012.6-47.2-3-10-13.8-22.8-23.8-28-5.6-2.8-7.8-5.2-7.8-8.4%200-8.6-8.6-38.4-15.8-55.6-20.4-47-59.6-84.2-107.8-101.8-31.2-11.4-53.2-14.8-95.4-14.6-34.8%200-39.8%200.4-58%205.2-11%203-27.6%209-36.6%2013.4-9.2%204.4-17.2%208-17.6%208-1.8%200-0.6-16.4%202.2-33.2%209.6-54.6%2038-108%2082.8-155.2l19.4-20.2%206.6%202.2c16.6%205.8%2033.4%201.4%2047.2-12.6%2019.6-19.4%2020.2-44.4%201.6-65-12.8-14.4-31.8-19.4-50.2-13.4zM705.8%20198c-32.2%2035.6-50%2060.6-66.2%2092.6C620%20330%20608%20378%20608%20418.2c0%2017.4-0.4%2019.8-4%2021.8-6%203.2-31.2%2033-43%2051-13.4%2020.4-29.4%2052.4-39%2077.6l-7.4%2019.6-5.4-17.4c-13-41.2-29-72.4-57.2-111.4-4.6-6.6-3.6-49.8%201.8-70.4%2018-69%2078.8-127.8%20178.2-172.2%2020-8.8%2081-32.4%2084.8-32.8%200.8%200-4.2%206.4-11%2014z%20m77.2%20220c54%206.2%2096.4%2026.4%20122.8%2058.4%209.4%2011.4%2026%2041.6%2029.2%2053.2%201.4%204.6%201.2%204.6-9.4-1.4-19-10.6-35.8-14.6-65.8-15.6-21.8-0.8-29.4-0.4-38.8%202.4-32%209.2-51.4%2028.6-62.6%2062.6-4.2%2013.2-5.2%2020-6%2047.8-0.8%2028.4-1.2%2032.6-4.2%2032.6-6.4%200-27.4%2011.6-35.6%2019.8L704%20686l-8.4-8.4c-4.8-4.4-14.4-11-21.6-14.4-12-5.8-14.6-6.2-34-6.2-18.8%200-22.2%200.6-33%205.6-6.6%203-16.2%209.8-21.4%2014.8l-9.4%209.2-10.2-9.2c-9-8-19.8-14.4-30.4-18-4.8-1.6-4.6-5.4%202.4-32.2%2016-62.4%2043.4-115.8%2077.8-151.8%2044.6-46.6%2098.4-65.2%20167.2-57.4zM277.2%20693.6c9.2%204.8%2017%2012.8%2021.8%2022%202.4%204.8%205.4%2028.2%2011.2%2085%204.2%2043.2%207.8%2078.6%207.8%2078.8%200%200.4-14.8%200.6-32.6%200.6h-32.8l-22.2-74c-22-73.6-22.2-74-19.4-83%208.6-29%2040-42.8%2066.2-29.4z%20m128%200c9%204.6%2016.8%2012.6%2022%2022.4%203.4%206.4%203.8%2013.4%204.4%2085.6l0.6%2078.4-40.6-0.4-40.6-0.6-7.4-73c-6.8-67-7.2-73.8-4.6-83%208.2-28.6%2040-42.8%2066.2-29.4z%20m128%200c9%204.6%2016.8%2012.6%2022%2022.4%203.4%206.4%203.8%2013.4%204.4%2085.4l0.6%2078.6H464v-73.6c0-80%200.6-86%2011-99.6%2013.6-17.8%2038.4-23.4%2058.2-13.2z%20m128%200c12.6%206.6%2022.2%2018.8%2025.6%2033%200.6%203-0.6%2023.6-2.8%2045.6-2.4%2022.2-3.6%2040.8-3%2041.4%201.4%201.4%2029.4%204.6%2030.6%203.4%200.4-0.4%202.8-21.8%205.4-47.6%205-50.2%206.8-57%2018.4-67.6%2010-9.4%2018.6-12.6%2032.6-12.6%209.4%200%2015.2%201.2%2021.2%204.2%2014%207.4%2024.8%2023.2%2025.2%2037.2%200%203.6-9.6%2038.6-21.4%2077.8L771.4%20880H706l1.4-15c1.4-17%202.4-16-17.8-17.8l-13.2-1.2-1.4%2017-1.4%2017H592v-73.6c0-80%200.6-86%2011-99.6%2013.6-17.8%2038.4-23.4%2058.2-13.2z'%20p-id='8033'%20fill='%232c2c2c'%3e%3c/path%3e%3c/svg%3e";class O extends E{constructor(){super(),this.init()}init(){this.el.className="card-wrap",this.insert()}renderCard(n,t){return n.toLocaleLowerCase()==="joker"?this.renderJoker(n,t):this.renderNums(n,t)}renderJoker(n,t){return`
      <div class="card-item joker">
        <div class="card-text"><img src=${n==="JOKER"?A:$} alt="${n}" /></div>
        <span class="card-num">${t}</span>
      </div>
    `}renderNums(n,t){return n==="10"?`
        <div class="card-item double-char">
          <div class="card-text"><span>${n}</span></div>
          <span class="card-num">${t}</span>
        </div>
      `:`
        <div class="card-item">
          <div class="card-text">${n}</div>
          <span class="card-num">${t}</span>
        </div>
      `}renderElement(n){return[...n.entries()].map(([t,s])=>this.renderCard(t,s)).join(`
`)}render(n){const t=n.data;this.el.innerHTML=this.renderElement(t)}}class D extends E{constructor(){super()}render(){}}const d=["3","4","5","6","7","8","9","10","J","Q","K","A"];function x(e,n){const[t,s]=e.split("-"),r=d.indexOf(t),i=d.lastIndexOf(s),c={};for(let o=r;o<=i;o++){const K=d[o];c[K]=n}return c}const h={single:{validate(e){return/^([2-9]|10|J|Q|K|A|<|>|<>|><)$/i.test(e)},generate(e){return e==="<"?{joker:1}:e===">"?{JOKER:1}:e==="<>"||e==="><"?{JOKER:1,joker:1}:{[e]:1}}},double:{validate(e){return/^D([2-9]|10|J|Q|K|A)$/i.test(e)},generate(e){return{[e.slice(1)]:2}}},sequence:{validate(e){return/^([3-9]|10|J|Q|K|A)-([3-9]|10|J|Q|K|A)$/i.test(e)},generate(e){return x(e,1)}},doubleSequence:{validate(e){return/^D([3-9]|10|J|Q|K|A)-D([3-9]|10|J|Q|K|A)$/i.test(e)},generate(e){return e=e.replace(/D/g,""),x(e,2)}},triplet:{validate(e){return/^T([2-9]|10|J|Q|K|A)$/i.test(e)},generate(e){return{[e.slice(1)]:3}}},tripletSequence:{validate(e){return/^T([3-9]|10|J|Q|K|A)-T([3-9]|10|J|Q|K|A)$/i.test(e)},generate(e){return e=e.replace(/T/g,""),x(e,3)}},quadriplet:{validate(e){return/^F([2-9]|10|J|Q|K|A)$/i.test(e)},generate(e){return{[e.slice(1)]:4}}}};function Q(e,n){const t={};for(const s in e)t[s]=s in n?e[s]+n[s]:e[s];for(const s in n)s in e||(t[s]=n[s]);return t}function g(e){return d.indexOf(e)}function y(e,n,t){const s=d.concat("2");for(let r=0;r<s.length;r++){const i=s[(r+n)%s.length];if(t.get(i)>=e)return i}return""}function w(e,n,t,s){const r=g(n);let i=r;for(let c=r;c<d.length;c++){const o=d[c];if(i-r+1>=e||s.get(o)<t)break;i=c}return i-r+1>=e?d[i]:""}function R(e){return e&&h.double.validate(e)?g(e.slice(1))+1:null}function M(e){return e&&h.triplet.validate(e)?g(e.slice(1))+1:null}function z(e){return e&&h.quadriplet.validate(e)?g(e.slice(1))+1:null}function P(e){if(e&&h.sequence.validate(e)){const[n,t]=e.split("-").map(s=>g(s));return t-n+1}return null}function H(e){if(e&&h.doubleSequence.validate(e)){const[n,t]=e.replace(/D/g,"").split("-").map(s=>g(s));return t-n+1}return null}function N(e){if(e&&h.tripletSequence.validate(e)){const[n,t]=e.replace(/T/g,"").split("-").map(s=>g(s));return t-n+1}return null}const B=/(^|,)D$/,T=/(^|,)([3-9]|10|J|Q|K|A)-$/,q=/(^|,)D([3-9]|10|J|Q|K|A)-$/,G=/(^|,)T$/,J=/(^|,)T([3-9]|10|J|Q|K|A)-$/,X=/(^|,)F$/;function _(e,n){var r;const t=n.getData(),s=(r=n.getLastestRecord())==null?void 0:r[1];if(B.test(e)){const i=R(s)||0;return e+y(2,i,t)}else if(T.test(e)){const i=e.match(T)[2],c=P(s)||5;return e+w(c,i,1,t)}else if(q.test(e)){const i=e.match(q)[2],c=H(s)||3,o=w(c,i,2,t);if(o)return e+"D"+o}else if(G.test(e)){const i=M(s)||0;return e+y(3,i,t)}else if(J.test(e)){const i=e.match(J)[2],c=N(s)||2,o=w(c,i,3,t);if(o)return e+"T"+o}else if(X.test(e)){const i=z(s)||0;return e+y(4,i,t)}return""}class j extends E{constructor(t){super();p(this,"storeInstance");p(this,"suggestionText");p(this,"handleInputEvent",t=>{const s=t.target;s.value=s.value.toUpperCase(),this.genSuggestion(s.value)});p(this,"handleKeydownEvent",t=>{if(["ArrowUp","ArrowDown"].includes(t.key)){const s=t.target;this.suggestionText&&(s.value=this.suggestionText),t.preventDefault()}else if(t.key==="Enter"){const s=t.target;if(!s.value)return;this.parseToken(s.value),s.value=""}else t.key===" "&&t.preventDefault()});this.storeInstance=t,this.suggestionText="",this.init()}init(){this.el.className="input-wrap",this.el.innerHTML=`
      <div class="input-container" data-prev-command="">
        <input type="text" class="inner-input" placeholder="" disabled />
        <input type="text" class="outter-input" value="" />
      </div>
      <button class="cancel-btn">撤销</button>
      <button class="reset-btn">重置</button>
    `,this.insert(),this.render()}initOutterInput(){const t=this.querySelector(".outter-input");t==null||t.addEventListener("input",this.handleInputEvent),t==null||t.addEventListener("keydown",this.handleKeydownEvent)}initCancelBtn(){var t;(t=this.querySelector(".cancel-btn"))==null||t.addEventListener("click",()=>{const s=this.querySelector(".outter-input");if(s.value){s.value="";return}const r=this.storeInstance.revocation();this.showSuggestion(r)})}initResetBtn(){var t;(t=this.querySelector(".reset-btn"))==null||t.addEventListener("click",()=>{this.storeInstance.reset()})}parseToken(t){t=this.formatToken(t);const s=t.split(",");let r={};s.forEach(i=>{for(const{validate:c,generate:o}of Object.values(h))c(i)&&(r=Q(r,o(i)))}),this.storeInstance.update(r,t),this.updatePrevCommand(),this.showSuggestion("")}formatToken(t){return t.replace(/[^0123456789JQKA,\-DTF><]/g,"")}genSuggestion(t){if(t!==this.formatToken(t)){this.showSuggestion("");return}const s=_(t,this.storeInstance);this.showSuggestion(s)}showSuggestion(t){this.suggestionText=t,this.querySelector(".inner-input").setAttribute("placeholder",t)}updatePrevCommand(){var s;const t=this.storeInstance.getLastestRecord();(s=this.querySelector(".input-container"))==null||s.setAttribute("data-prev-command",`上一次输入：${(t==null?void 0:t[1])||""}`)}querySelector(t){return this.el.querySelector(t)}render(){this.initOutterInput(),this.initCancelBtn(),this.initResetBtn()}}const C=new O,F=new D,U=new I(C,F);new j(U);
